<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Love Capsule PRO ğŸ’˜</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background: linear-gradient(135deg,#ff4e8a,#ff9ecf);
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
  color:white;
  text-align:center;
}

.container{
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(15px);
  padding:30px;
  border-radius:20px;
  width:90%;
  max-width:450px;
  box-shadow:0 0 40px rgba(0,0,0,0.3);
  z-index:2;
}

input, textarea{
  width:100%;
  padding:10px;
  margin:10px 0;
  border:none;
  border-radius:10px;
  outline:none;
}

button{
  padding:10px 20px;
  border:none;
  border-radius:20px;
  background:white;
  color:#ff4e8a;
  font-weight:bold;
  cursor:pointer;
  transition:0.3s;
}

button:hover{
  background:#ff4e8a;
  color:white;
}

.hidden{ display:none; }

.heart{
  position:absolute;
  color:white;
  animation: float 6s linear infinite;
  font-size:20px;
}

@keyframes float{
  0%{ transform: translateY(100vh) scale(1); opacity:1;}
  100%{ transform: translateY(-10vh) scale(1.5); opacity:0;}
}
</style>
</head>
<body>

<div class="container" id="formBox">
  <h2>ğŸ’˜ ØµØ§ÙŠØ¨ Ø±Ø³Ø§Ù„Ø© Ø³Ø±Ù‘ÙŠØ©</h2>
  <input type="text" id="sender" placeholder="Ø³Ù…ÙŠØªÙƒ">
  <input type="text" id="receiver" placeholder="Ø³Ù…ÙŠØ© Ø§Ù„Ø­Ø¨ÙŠØ¨/Ø©">
  <textarea id="message" placeholder="ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© Ø­Ø¨ ğŸ’Œ"></textarea>
  <input type="datetime-local" id="unlockTime">
  <button onclick="generateLink()">ØªÙˆÙ„ÙŠØ¯ Ù„ÙŠÙ†Ùƒ Ø³Ø±ÙŠ</button>
  <p id="linkOutput"></p>
</div>

<div class="container hidden" id="countdownBox">
  <h2>â³ Ø§Ù„Ù…ÙØ§Ø¬Ø£Ø© ØºØ§Ø¯ÙŠ ØªØªØ­Ù„ Ø¨Ø¹Ø¯...</h2>
  <div id="countdown"></div>
</div>

<div class="container hidden" id="messageBox">
  <h2 id="finalTitle"></h2>
  <p id="finalMessage"></p>
</div>

<script>
function generateLink(){
  const sender = document.getElementById("sender").value;
  const receiver = document.getElementById("receiver").value;
  const message = document.getElementById("message").value;
  const time = document.getElementById("unlockTime").value;

  if(!sender || !receiver || !message || !time){
    alert("Ø¹Ù…Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª â¤ï¸");
    return;
  }

  const data = {
    s: sender,
    r: receiver,
    m: message,
    t: time
  };

  const encoded = btoa(unescape(encodeURIComponent(JSON.stringify(data))));
  const link = window.location.origin + window.location.pathname + "#" + encoded;

  document.getElementById("linkOutput").innerHTML =
    "ğŸ” Ø§Ù„Ù„ÙŠÙ†Ùƒ Ø§Ù„Ø³Ø±ÙŠ:<br><a href='"+link+"' style='color:white'>"+link+"</a>";
}

function loadFromHash(){
  if(window.location.hash){
    const decoded = JSON.parse(decodeURIComponent(escape(atob(window.location.hash.substring(1)))));
    startCountdown(decoded);
  }
}

function startCountdown(data){
  document.getElementById("formBox").classList.add("hidden");
  document.getElementById("countdownBox").classList.remove("hidden");

  const unlockDate = new Date(data.t).getTime();

  const interval = setInterval(()=>{
    const now = new Date().getTime();
    const distance = unlockDate - now;

    if(distance <= 0){
      clearInterval(interval);
      showMessage(data);
      return;
    }

    const days = Math.floor(distance/(1000*60*60*24));
    const hours = Math.floor((distance%(1000*60*60*24))/(1000*60*60));
    const minutes = Math.floor((distance%(1000*60*60))/(1000*60));
    const seconds = Math.floor((distance%(1000*60))/1000);

    document.getElementById("countdown").innerHTML =
      days+" ÙŠÙˆÙ… "+hours+" Ø³Ø§Ø¹Ø© "+minutes+" Ø¯Ù‚ÙŠÙ‚Ø© "+seconds+" Ø«Ø§Ù†ÙŠØ© â¤ï¸";
  },1000);
}

function showMessage(data){
  document.getElementById("countdownBox").classList.add("hidden");
  document.getElementById("messageBox").classList.remove("hidden");

  document.getElementById("finalTitle").innerHTML =
    "ğŸ’– Ù…Ù† "+data.s+" Ø¥Ù„Ù‰ "+data.r;
  document.getElementById("finalMessage").innerHTML = data.m;

  startHearts();
}

function startHearts(){
  setInterval(()=>{
    const heart = document.createElement("div");
    heart.classList.add("heart");
    heart.innerHTML="â¤ï¸";
    heart.style.left = Math.random()*100+"vw";
    heart.style.fontSize = (15+Math.random()*30)+"px";
    document.body.appendChild(heart);

    setTimeout(()=>{heart.remove();},6000);
  },300);
}

loadFromHash();
</script>

</body>
</html>
